export default (/** @type {Record<string, string>} */ headers) => {
  if (headers['flux-fingerprint'] && headers['user-agent'] === 'Fluxus') {
    return 'fluxus'
  }
  if (headers['electronid']) {
    return 'electron'
  }
  if (!headers['user-agent']) return false
  if (
    headers['user-agent'].startsWith('synx') &&
    headers['synapse-fingerprint'] &&
    headers['syn-user-identifier']
  ) {
    return 'synapse'
  }
  if (headers['user-agent'].startsWith('ScriptWare') && headers['fingerprint'] && headers['user-identifier']) {
    return 'scriptware'
  }
  if (headers['user-agent'] === 'Krnl') {
    return 'krnl'
  }
  if (headers['user-agent'] === 'sentinel') {
    return 'sentinel'
  }
  if (
    Object.keys(headers).find((key) => key.endsWith('-fingerprint')) ||
    headers['user-agent'].startsWith('Roblox/WinInet')
  ) {
    return 'unknown'
  }
}
